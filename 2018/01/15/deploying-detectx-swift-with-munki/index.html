<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Deploying DetectX Swift with Munki - Zack McCauley</title>
    <meta name="description" content="Hi, I’m a macadmin for a school district in Montana. I like to program things sometimes. I am always learning.
">
    <meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Deploying DetectX Swift with Munki - Zack McCauley"><meta property="og:site_name" content="Zack McCauley"><meta property="og:description" content="Hi, I’m a macadmin for a school district in Montana. I like to program things sometimes. I am always learning."><meta property="og:url" content="https://wardsparadox.github.io/2018/01/15/deploying-detectx-swift-with-munki/"><meta property="article:published_time" content="2018-01-15T10:25:00-07:00"><meta property="article:author" content="https://wardsparadox.github.io/about">

    

    
    <meta name="google-site-verification" content="99065592" />
    

    <link rel="alternate" type="application/rss+xml" href="https://wardsparadox.github.io/feed.xml">
    <link rel="shortcut icon" href="https://wardsparadox.github.io/favicon.ico">
    <link rel="prefetch" href="https://wardsparadox.github.io">
    <link rel="canonical" href="https://wardsparadox.github.io/2018/01/15/deploying-detectx-swift-with-munki/">
    <link rel="stylesheet"
    href="https://wardsparadox.github.io/assets/css/main.css">
    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="57x57" href="https://wardsparadox.github.io/assets/images/favicons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="https://wardsparadox.github.io/assets/images/favicons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="https://wardsparadox.github.io/assets/images/favicons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="https://wardsparadox.github.io/assets/images/favicons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114"  href="https://wardsparadox.github.io/assets/images/favicons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120"  href="https://wardsparadox.github.io/assets/images/favicons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144"  href="https://wardsparadox.github.io/assets/images/favicons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152"  href="https://wardsparadox.github.io/assets/images/favicons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180"  href="https://wardsparadox.github.io/assets/images/favicons/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="https://wardsparadox.github.io/assets/images/favicons/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://wardsparadox.github.io/assets/images/favicons/android-chrome-192x192.png"  sizes="192x192">
    <link rel="icon" type="image/png" href="https://wardsparadox.github.io/assets/images/favicons/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="https://wardsparadox.github.io/assets/images/favicons/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="https://wardsparadox.github.io/assets/images/favicons/manifest.json">
    <link rel="mask-icon" href="https://wardsparadox.github.io/assets/images/favicons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#fffff">
    <meta name="msapplication-TileImage" content="https://wardsparadox.github.io/assets/images/favicons/mstile-144x144.png">
    <meta name="themesettings-color" content="#ffffff">
    <!-- /Favicons -->

    <!-- IE Fixes -->
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
<link href="//netdna.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.css" rel="stylesheet">
    <style type="text/css">a,.post-title a{color:#2192BB}a:hover{border-bottom-color:#2192BB}.sidebar{background-color:#2192BB}.wc-top,.sidebar-toggle:active,#sidebar-checkbox:checked ~ .sidebar-toggle{background-color:#2192BB}.sidebar a:hover,.sidebar .sidebar-nav a{border-bottom-color:#25a3d1}.sidebar .sidebar-nav{border-top-color:#25a3d1}.sidebar .sidebar-nav a.sidebar-nav-item:hover,.sidebar .sidebar-nav a.sidebar-nav-item:focus{background:#239cc8}.sidebar .sidebar-nav .sidebar-nav-item.active{background-color:#1f88ae}ul.social-media li>a{background-color:#1f88ae;border-color:#25a3d1;border-bottom-color:#25a3d1 !important}ul.social-media li>a:hover{background-color:#e1f3fa}.btn{border-color:#2192BB;background:#2192bb}.btn:hover,.btn:focus{border-color:#1d81a5;background:#1d81a5}</style>
  </head>
  <body>
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><div class="sidebar" id="sidebar">    <img    src="https://wardsparadox.github.io/assets/images/avatar.jpg"    alt="Zack McCauley" />    <div class="sidebar-info">      <p>        Hi, I’m a macadmin for a school district in Montana. I like to program things sometimes. I am always learning.      </p>  </div>  <nav class="sidebar-nav">    <a class="sidebar-nav-item"      href="https://wardsparadox.github.io/">      Home    </a>                <a class="sidebar-nav-item "      href="https://wardsparadox.github.io/about">      About me    </a>                <a class="sidebar-nav-item "      href="https://wardsparadox.github.io/archive">      Blog Archive    </a>                <a class="sidebar-nav-item "      href="https://wardsparadox.github.io/tags">      Tags    </a>      </nav>  <div class="sidebar-info small">     <p>       Made by <a href="https://github.com/gayanvirajith/gaya" target="_blank">Gayan Virajith</a> For everyone.       Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a>     </p>  </div>  <ul class="social-media">        <li>        <a title="mccauley_zack on Twitter"            href="https://twitter.com/mccauley_zack"            class="twitter wc-img-replace" target="_blank">Twitter</a>    </li>            <li>        <a title="108452882684071984253 on Google Plus"            href="https://plus.google.com/108452882684071984253"            class="google wc-img-replace" target="_blank">Google</a>    </li>                <li>        <a title="wardsparadox on Github"            href="https://github.com/wardsparadox"            class="github wc-img-replace" target="_blank">Github</a>    </li>                    <li>        <a title="zack_mccauley @ macadmins.org on Slack"            href="https://www.macadmins.org/"            class="slack wc-img-replace" target="_blank">Slack</a>    </li>        <li>        <a title="Subscribe via RSS"            href="https://wardsparadox.github.io/feed.xml"            class="rss wc-img-replace" target="_blank">            RSS        </a>    </li></ul></div>

    <div class="main-wrapper">
      <div class="header">
        <div class="container">
          <div class="header-logo"><a href="https://wardsparadox.github.io/"   title="Zack McCauley">  <img     src="https://wardsparadox.github.io/assets/images/logo.jpg"    alt="Zack McCauley" /></a></div>
          <div class="header-title">
            <a href="https://wardsparadox.github.io/"
              title="Zack McCauley">
              <h3>Zack McCauley<small>Fixer of Machines, Breaker of Code</small></h3>
            </a>
          </div>
        </div>
      </div>

      <div class="container content">
          <div class="post">

  

  

  <header class="post-header">
    <h1 class="post-title">Deploying DetectX Swift with Munki</h1>
    <p class="post-meta">
    
      <span class="categories">
      munki
      </span> |
    
    <span class="post-date">
    Jan 15, 2018
    </span>
    </p>
  </header>

  <article class="post-content">
    <p>DetectX Swift is an alternative to MalwareBytes Anti-Malware and was more economical for our district to use. It also is faster and more what we were looking for. I highly recommend it! This is a write up based on how we are deploying it here.</p>

<!--more-->
<h3 id="first-things-first-if-you-are-reading-this-you-will-need-a-management-license-from-sqwarq-for-detectx-swift-cost-is-299-usd-once-you-have-this-make-note-of-the-information-in-the-email-with-the-account-information"><strong>First things first, if you are reading this, you will need a Management License from Sqwarq for DetectX Swift; Cost is $299 USD. Once you have this, make note of the information in the email with the account information.</strong></h3>

<p>We decided to deploy it to <code class="highlighter-rouge">/Applications/Utilities</code>. This makes it still easy to access but out of the standard users view. We deploy it via Munki as well. You will also need to add a <code class="highlighter-rouge">post-install</code> script to register the client. Thankfully DetectX Swift allows for re-registering with no issue, so you can “register” it after every installation. Here is the <code class="highlighter-rouge">pkginfo</code> dict for the <a href="https://github.com/autopkg/autopkg">autopkg</a> recipe:</p>
<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;key&gt;</span>pkginfo<span class="nt">&lt;/key&gt;</span>
<span class="nt">&lt;dict&gt;</span>
  <span class="nt">&lt;key&gt;</span>catalogs<span class="nt">&lt;/key&gt;</span>
  <span class="nt">&lt;array&gt;</span>
    <span class="nt">&lt;string&gt;</span>testing<span class="nt">&lt;/string&gt;</span>
  <span class="nt">&lt;/array&gt;</span>
  <span class="nt">&lt;key&gt;</span>description<span class="nt">&lt;/key&gt;</span>
  <span class="nt">&lt;string&gt;</span>DetectX Swift is a shareware security and troubleshooting tool that uses a combination of hardcoded search definitions along with live updates and predictive heuristics to detect both known and unknown threats and issues. It provides the user with multiple analytical capabilities regarding both the system’s current state and changes to its state over time related to its ongoing security and performance.<span class="nt">&lt;/string&gt;</span>
  <span class="nt">&lt;key&gt;</span>category<span class="nt">&lt;/key&gt;</span>
  <span class="nt">&lt;string&gt;</span>Utlities<span class="nt">&lt;/string&gt;</span>
  <span class="nt">&lt;key&gt;</span>developer<span class="nt">&lt;/key&gt;</span>
  <span class="nt">&lt;string&gt;</span>Philip Stokes<span class="nt">&lt;/string&gt;</span>
  <span class="nt">&lt;key&gt;</span>display_name<span class="nt">&lt;/key&gt;</span>
  <span class="nt">&lt;string&gt;</span>DetectX Swift<span class="nt">&lt;/string&gt;</span>
  <span class="nt">&lt;key&gt;</span>name<span class="nt">&lt;/key&gt;</span>
  <span class="nt">&lt;string&gt;</span>%NAME%<span class="nt">&lt;/string&gt;</span>
  <span class="nt">&lt;key&gt;</span>unattended_install<span class="nt">&lt;/key&gt;</span>
  <span class="nt">&lt;true/&gt;</span>
  <span class="nt">&lt;key&gt;</span>items_to_copy<span class="nt">&lt;/key&gt;</span>
  <span class="nt">&lt;array&gt;</span>
    <span class="nt">&lt;dict&gt;</span>
      <span class="nt">&lt;key&gt;</span>destination_path<span class="nt">&lt;/key&gt;</span>
      <span class="nt">&lt;string&gt;</span>/Applications/Utilities<span class="nt">&lt;/string&gt;</span>
      <span class="nt">&lt;key&gt;</span>source_item<span class="nt">&lt;/key&gt;</span>
      <span class="nt">&lt;string&gt;</span>DetectX Swift.app<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;/dict&gt;</span>
  <span class="nt">&lt;/array&gt;</span>
  <span class="nt">&lt;key&gt;</span>minimum_os_version<span class="nt">&lt;/key&gt;</span>
  <span class="nt">&lt;string&gt;</span>10.11<span class="nt">&lt;/string&gt;</span>
<span class="nt">&lt;/dict&gt;</span>
<span class="nt">&lt;key&gt;</span>postinstall_script<span class="nt">&lt;/key&gt;</span>
<span class="nt">&lt;string&gt;</span>#!/bin/bash
"/Applications/Utilities/DetectX Swift.app/Contents/MacOS/DetectX Swift" register -key "KEYNUMBER" -email "REGISTEREDEMAIL"

"/Applications/Utilities/DetectX Swift.app/Contents/MacOS/DetectX\ Swift" search -aj "/usr/local/munki/preflight.d/cache/detectx.json"
<span class="nt">&lt;/string&gt;</span>
</code></pre>
</div>

<p>If you are using MunkiReport-PHP, there is a module I created in the current WIP branch. WIP is not stable for production, but should be entering beta soon. In order to use the module you will need to create a launchDaemon targeting DetectX Swift’s CLI tool to output a JSON file. There is an example in the module READMD file.
<img src="/assets/images/content images/detectXWidget.png" alt="detectXWidget" /></p>

<p>I am deploying a boot-every script with <a href="https://github.com/chilcote/outset">Outset</a> that does the same thing. I packaged this up as an <code class="highlighter-rouge">update_for</code> in Munki. This will provide a dashboard that will give you in-depth look at the current status of your fleet. The client tab will show you exactly what each client shows for each infection. The command structure for this is as follows:</p>
<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="s2">"/Applications/Utilities/DetectX Swift.app/Contents/MacOS/DetectX</span><span class="se">\ </span><span class="s2">Swift"</span> search -aj <span class="s2">"/usr/local/munki/preflight.d/cache/detectx.json"</span>
</code></pre>
</div>
<p>This will scan (if you are running it independently you must run it as root!) all users homes and report on it’s findings. It is fairly quick. If you combine all of this together you get an auto-updating anti-malware solution that reports to a dashboard for every machine you deploy it too. If there are machines supsected of having malware, we call the employee and request they do a quick restart so that the <code class="highlighter-rouge">boot-every</code> script has a chance to report, then perform a Munki update check to send the data to us. So far this has proven effective and useful here.</p>

  </article>

  
    <div class="related-posts">
      <h4>Related Posts</h4>
      <ul>
        
          <li>
            <h5>
              <a href="https://wardsparadox.github.io/2018/02/14/setting-up-munkireport-php-on-ubuntu-16-with-nginx/">
                Setting up MunkiReport-PHP on Ubuntu 16 with Nginx
                <small>14 Feb 2018</small>
              </a>
            </h5>
          </li>
        
          <li>
            <h5>
              <a href="https://wardsparadox.github.io/2018/01/29/faster-munki-downloads-from-nginx/">
                Faster Munki Downloads from Nginx
                <small>29 Jan 2018</small>
              </a>
            </h5>
          </li>
        
          <li>
            <h5>
              <a href="https://wardsparadox.github.io/2017/05/29/dock-maintainer-defined/">
                Dock-maintainer: Defined
                <small>29 May 2017</small>
              </a>
            </h5>
          </li>
        
      </ul>
    </div>
  

  <div class="author-info">
    
      <div class="author">   <a href="https://wardsparadox.github.io/about">    <img      src="https://wardsparadox.github.io/assets/images/avatar.jpg"      alt="Zack McCauley" width="60" height="60" />  </a>    <h5>Author</h4>  <h6>    <a href="https://wardsparadox.github.io/about">      Zack McCauley    </a>  </h5>  <p>    Find me on            <a title="wardsparadox on GitHub"            href="https://github.com/wardsparadox"            class="github" target="_blank">Github</a>                /        <a title="zack_mccauley @ macadmins.org on slack"            href="https://macadmins.org/"            class="slack" target="_blank">Slack</a>                /        <a title="108452882684071984253 on Google Plus"            href="https://plus.google.com/108452882684071984253"            class="google" target="_blank">Google</a>      </p></div>

    

    
      <div class="share-buttons">  <h5>Share this post on</h5>  <ul class="social-media">    <li>        <a title="mccauley_zack on Twitter"           href="https://twitter.com/intent/tweet?original_referer=https://wardsparadox.github.io/2018/01/15/deploying-detectx-swift-with-munki/&amp;text=Deploying DetectX Swift with Munki&amp;url=https://wardsparadox.github.io/2018/01/15/deploying-detectx-swift-with-munki/" class="twitter wc-img-replace" target="_blank">          Twitter        </a>    </li>       <li>        <a title="108452882684071984253 on Google Plus"             href="https://plus.google.com/share?url=https://wardsparadox.github.io/2018/01/15/deploying-detectx-swift-with-munki/"             class="google wc-img-replace" target="_blank">Google</a>    </li>    <li>        <a title=" on Facebook"             href="https://www.facebook.com/sharer/sharer.php?u=https://wardsparadox.github.io/2018/01/15/deploying-detectx-swift-with-munki/&amp;t=Deploying DetectX Swift with Munki"             class="facebook wc-img-replace" target="_blank">Facebook</a>    </li>  </ul></div>
    
  </div>

  
</div>

      </div>
      <a href="#0" class="wc-top">Top</a>

    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle">
      <span></span>
    </label>

    <script type="text/javascript">
      var config = {
        "browser_warning_page": "https://wardsparadox.github.io/browser-warning/",
        "disqus_shortname": ""
      };
      /* Browser support detection */
      var browserSupport = (function(){
        var htmlElemClasses = document.querySelector('html').className.split(' ');
        for ( var i = 0; i < htmlElemClasses.length; i += 1 ){
          var className = htmlElemClasses[i];
          if ( className === 'lt-ie9' ){
            return true;
          }
        }
      }());

      if (browserSupport){
        window.location="https://wardsparadox.github.io/browser-warning/";
      }

      /* To avoid render blocking css */
      var cb = function() {
        var l = document.createElement('link'); l.rel = 'stylesheet';
        l.href = 'https://fonts.googleapis.com/css?family=PT+Sans';
        var h = document.getElementsByTagName('head')[0]; h.parentNode.insertBefore(l, h);
      };
      var raf = requestAnimationFrame || mozRequestAnimationFrame ||
          webkitRequestAnimationFrame || msRequestAnimationFrame;
      if (raf) raf(cb);
      else window.addEventListener('load', cb);


    </script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script async type="text/javascript" src="https://wardsparadox.github.io/assets/js/gaya.min.js"></script>

    
    
<script type="text/javascript">var _gaq = _gaq || [];_gaq.push(['_setAccount', 'UA-99065592-1']);_gaq.push(['_trackPageview']);(function() {var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);})();</script>

  </body>
</html>
